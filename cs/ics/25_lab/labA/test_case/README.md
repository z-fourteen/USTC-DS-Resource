# LC-3 Assembler & Simulator 测试集

本目录包含了一系列用于验证 LC-3 汇编器（Assembler）和模拟器（Simulator）功能的测试用例。这些测试涵盖了从基础指令集到常见算法的验证。

## 目录结构

- **`asm/`**: 存放基础指令测试和算法测试的汇编源代码 (`.asm`)。
- **`lab/`**: 存放本课程lab1和lab2的参考代码，你可以使用自己的代码进行测试。
- **`bin/`**: 存放汇编生成的二进制机器码文件（由汇编器生成）。
- **`symbol/`**: 存放汇编生成的符号表文件（由汇编器生成）。
- **`lastyear/`**: 存放往年实验中使用的测试用例。

## 测试用例说明

### 1. 基础指令测试 (Basic Instruction Tests)
这些测试主要用于验证 LC-3 指令集的正确性，确保每条指令的行为符合 ISA 规范。

| 文件名 | 描述 | 重点测试内容 |
| :--- | :--- | :--- |
| `test_add.asm` | 加法指令测试 | `ADD` (寄存器模式 & 立即数模式), 条件码 (CC) 更新 |
| `test_and_not.asm` | 逻辑运算测试 | `AND`, `NOT` 指令, 位运算逻辑 |
| `test_branch.asm` | 分支跳转测试 | `BR`, `BRn`, `BRz`, `BRp` 及其组合 |
| `test_jump.asm` | 无条件跳转测试 | `JMP` 指令 |
| `test_load_store.asm` | 数据存取测试 | `LD`, `ST`, `LDI`, `STI`, `LDR`, `STR`, `LEA` |
| `test_subroutine.asm` | 子程序调用测试 | `JSR`, `JSRR`, `RET` 及堆栈保存返回地址 |

### 2. 算法与逻辑测试 (Algorithm & Logic Tests)
这些测试通过实现常见算法进一步验证逻辑处理能力和汇编器的伪指令支持。

| 文件名 | 描述 | 重点测试内容 |
| :--- | :--- | :--- |
| `multiplication.asm` | 乘法实现 | 循环累加实现乘法 |
| `string_length.asm` | 字符串长度计算 | `.STRINGZ` 伪指令, 内存遍历, 字符处理 |
| `fibonacci.asm` | 斐波那契数列 | 循环计算斐波那契数列 |
| `stack_operations.asm` | 栈操作测试 | 手动实现 `PUSH`/`POP` |
| `recursion.asm` | 递归调用测试 | 递归函数实现, 计算阶乘 |

### 3.往年样例（lastyear）

由于本次实验并未提供形如往年的代码的框架，基于自己的实现，输出可能与output中不一致，因此lastyear中的测试样例仅供参考，验收试验时不做要求。但是你可以参考这些样例来完善自己的实验。



## 汇编器（Assembler）

![image-20251227163309876](assets\image-20251227163309876.png)

- 第一条，你只需要输出格式如`symbol`中的目录下的符号表文件的结果即可
- 第二条，你只需要输出格式如`bin`中的目录下的二进制机器码文件的结果即可

符号表文件和二进制代码的具体格式不做要求，你可以如上图输出对应指令的地址，后接指令的二进制表示，也可参考lab1我们编写的二进制代码，第一行指定起始地址，后接每条指令的二进制表示。


**但是，你必须根据你的输出格式，编写相应的脚本，验证你的汇编器输出的符号表文件和二进制机器码文件与`symbol`和`bin`目录下的参考文件的一致性。**


## 模拟器（Simulator）

![image-20251227164842398](assets\image-20251227164842398.png)

- 第一条，可以通过读取初始化文件或者交互式输入的方式，初始化寄存器和内存。
- 第二条，你应该实现单步调试和断点功能，并支持输出指定寄存器和内存地址的内容。（不要求设置寄存器和内存地址的内容）
- 第三条，如果你实现了第二条中的断点功能，那么第三条你只需要额外实现输出程序运行的指令数即可。
- 此外，由于测试样例中使用了PUTS指令输出pass or fail，以及halt，但是实验对此并未做要求。因此，你可以考虑使用第二条中的断点功能，在执行到该指令时停止执行，并输出寄存器和内存状态。或者直接结束模拟器运行并输出寄存器和内存状态。
- 对于模拟器实验，可以修改输出的二进制文件格式，以适应你的实现。也可以修改为从内存读取测试样例的输入。

## all in all

本次实验未提供框架，因此对于大家的实现和验证方式并不做强制要求。如果你有自己的想法，也不必完全按照上述要求来实现和验证。

此测试样例主要是验证实现的功能完整性与正确性，并未严格检查立即数范围，语法错误问题。但是实验验收时会检查这些模块的逻辑，因此你仍然需要实现这些模块，并参考往年样例完善自己的实现。